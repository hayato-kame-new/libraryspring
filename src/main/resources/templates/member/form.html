<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link th:href="@{/css/style.css}" rel="stylesheet"/>
<title th:text="|#{member_form_page.title} - library|"></title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- フラグメントを組み込む th:include の値は 読み込むファイルの.htmlを抜いたパス :: th:fragmentに指定した値 
パスは templatesからのパス -->
<style th:include="common/header :: common_header_style"></style>
</head>
<body>
<!-- フラグメントの組み込み th:include の値は 読み込むファイルの.htmlを抜いたパス :: th:fragmentに指定した値 
パスは templatesからのパス-->
<div th:include="common/header :: common_header"></div>
<!-- 三項演算子のネストの書き方
<div th:text="${prod.Num=='12'} ? '準備中' : ${prod.Num=='13' && prod.sis=='春'} ? '出力' : '123'"></div> 
-->

<h3 class="heading" th:text="${action == 'add'} ?  '会員 新規登録画面' : ${action == 'edit' ? '会員 編集画面' : '会員 削除確認画面 この本を削除してよろしいですか?'}"></h3>

<form th:action="@{/member_add_edit}" method="post" th:object="${member}">

	<input type="hidden" name="action" th:value="${action}" />
	<!-- hidden で送る idは 新規の時には int型のデフォルト値(規定値) の 0 です 編集の時には idが入ってるので使用できる -->
	<input type="hidden" name="id" th:value="*{id}" />
	
	<p th:if="${id != null && id != 0}" th:text="|会員ID: *{id}|" ></p>
	
	<div>
		<label for="name">名前: </label> 
		<input type="text" id="name" name="name" th:value="*{name}" th:errorclass="err" />		
		<div th:if="${#fields.hasErrors('name')}" th:errors="*{name}" th:errorclass="err">
		</div>				
	</div>
	
	<div>
		<label for="tel">電話: </label>
		<input type="text" id="tel" name="tel" th:value="*{tel}" th:errorclass="err" />		
		<div th:if="${#fields.hasErrors('tel')}" th:errors="*{tel}" th:errorclass="err">
		</div>				
	</div>
	
	<div>
		<label for="address">住所: </label>
		<input type="text" id="address" name="address" th:value="*{address}" th:errorclass="err" />		
		<div th:if="${#fields.hasErrors('address')}" th:errors="*{address}" th:errorclass="err">
		</div>				
	</div>
		
	<th:block th:if="${action.equals('add') || action.equals('edit')}">
		<div>
			<input type="submit" value="送信" />
			<input type="reset" value="キャンセル">
		</div>
	</th:block>
</form>
	<th:block th:if="${action.equals('delete')}" >
		<form th:action = @{/member_delete} method="post" th:object="${member}" onsubmit="return beforeSubmit()">
		    <input type="hidden" name="id" th:value="${member.id}" />
		    <input type="submit" value="削除します" />
		</form>
	
	</th:block>

<hr />

<div>
	<a href="/members" th:href="@{/members}"><button type="button" >会員 一覧画面へ戻る</button></a>
</div>


<!-- Font Awesomeのための -->
<script defer src="https://use.fontawesome.com/releases/v5.7.2/js/all.js"></script>

<!-- <script>
(function($){
    function formSetDay(){
      var lastday = formSetLastDay($('.js-changeYear').val(), $('.js-changeMonth').val());
      var option = '';
      for (var i = 1; i <= lastday; i++) {
        if (i === $('.js-changeDay').val()){
          option += '<option value="' + i + '" selected="selected">' + i + '</option>\n';
        }else{
          option += '<option value="' + i + '">' + i + '</option>\n';
        }
      }
      $('.js-changeDay').html(option);
    }

    function formSetLastDay(year, month){
      var lastday = new Array('', 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
      if ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0){
        lastday[2] = 29;
      }
      return lastday[month];
    }

    $('.js-changeYear, .js-changeMonth').change(function(){
      formSetDay();
    });
  })(jQuery);
</script> -->

<script>
function beforeSubmit() {
    if(window.confirm('本当に削除しますか？')) {
      return true;
    } else {
      return false;
    }
  }
</script>
</body>
</html>